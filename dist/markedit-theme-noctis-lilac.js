"use strict";const X=require("@codemirror/state"),e=require("@lezer/highlight"),k=require("markedit-api"),j=require("@codemirror/view"),v=require("@codemirror/language"),C=(a,n={})=>a??n,Y=C(k.MarkEdit.userSettings),q=F("extension.markeditTheming"),Z=y(!1)?C(q.lightTheme):void 0,tt=y(!0)?C(q.darkTheme):void 0;function F(a){return a===void 0?{}:C(Y[a])}function G(a){return a.enabledMode??"both"}function y(a,n=G(q)){return["both",a?"dark":"light"].includes(n)}function et(a,n,t){const c=ot({lhs:t,rhs:a?tt:Z});return{extensions:[...a?E(c,{dark:!0}):E(c),n].filter(r=>r!==void 0),colors:c}}function E(a,n){const t={},c=[],o=a.editor,r=a.highlight;o?.textColor&&(t["&"]??={},t["&"].color=o?.textColor,t[".cm-activeLineGutter"]={backgroundColor:o?.textColor}),o?.backgroundColor&&(t["&"]??={},t["&"].backgroundColor=o?.backgroundColor),o?.activeLineBackground&&(t[".cm-activeLine"]={backgroundColor:o?.activeLineBackground}),o?.caretColor&&(t[".cm-content"]={caretColor:o?.caretColor},t[".cm-cursor, .cm-dropCursor"]={borderLeftColor:o?.caretColor}),o?.selectionBackground&&(t["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:o?.selectionBackground}),o?.matchingBracketBackground&&(t["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:o?.matchingBracketBackground}),o?.gutterText&&(t[".cm-gutters"]??={},t[".cm-gutters"].color=o?.gutterText),o?.gutterBackground&&(t[".cm-gutters"]??={},t[".cm-gutters"].backgroundColor=o?.gutterBackground,t[".cm-gutters"].border="none"),o?.foldPlaceholderText&&(t[".cm-foldPlaceholder"]??={},t[".cm-foldPlaceholder"].color=o?.foldPlaceholderText),o?.foldPlaceholderBackground&&(t[".cm-foldPlaceholder"]??={},t[".cm-foldPlaceholder"].backgroundColor=o?.foldPlaceholderBackground,t[".cm-foldPlaceholder"].border="none"),o?.searchMatchBackground&&(t[".cm-searchMatch"]={backgroundColor:o?.searchMatchBackground}),o?.selectionMatchBackground&&(t[".cm-selectionMatch"]={backgroundColor:o?.selectionMatchBackground}),r?.heading&&c.push({tag:e.tags.heading,color:r?.heading}),r?.bold&&c.push({tag:e.tags.strong,color:r?.bold}),r?.italic&&c.push({tag:e.tags.emphasis,color:r?.italic}),r?.strikethrough&&c.push({tag:e.tags.strikethrough,color:r?.strikethrough}),r?.quote&&c.push({tag:e.tags.quote,color:r?.quote}),r?.link&&c.push({tag:[e.tags.url,e.tags.link],color:r?.link}),r?.divider&&c.push({tag:e.tags.contentSeparator,color:r?.divider}),r?.comment&&c.push({tag:e.tags.comment,color:r?.comment}),r?.meta&&c.push({tag:e.tags.meta,color:r?.meta}),r?.keyword&&c.push({tag:e.tags.keyword,color:r?.keyword}),r?.atom&&c.push({tag:[e.tags.atom,e.tags.bool],color:r?.atom}),r?.literal&&c.push({tag:[e.tags.literal,e.tags.inserted],color:r?.literal}),r?.string&&c.push({tag:[e.tags.string,e.tags.deleted],color:r?.string}),r?.special&&c.push({tag:[e.tags.regexp,e.tags.escape,e.tags.special(e.tags.string)],color:r?.special}),r?.variable&&c.push({tag:e.tags.definition(e.tags.variableName),color:r?.variable}),r?.local&&c.push({tag:e.tags.local(e.tags.variableName),color:r?.local}),r?.type&&c.push({tag:[e.tags.typeName,e.tags.namespace],color:r?.type}),r?.class&&c.push({tag:e.tags.className,color:r?.class}),r?.macro&&c.push({tag:[e.tags.special(e.tags.variableName),e.tags.macroName],color:r?.macro}),r?.property&&c.push({tag:e.tags.definition(e.tags.propertyName),color:r?.property}),r?.label&&c.push({tag:e.tags.labelName,color:r?.label}),r?.operator&&c.push({tag:[e.tags.operator,e.tags.operatorKeyword],color:r?.operator}),r?.constant&&c.push({tag:[e.tags.color,e.tags.constant(e.tags.name),e.tags.standard(e.tags.name)],color:r?.constant}),r?.instruction&&c.push({tag:[e.tags.separator,e.tags.processingInstruction,e.tags.definition(e.tags.name)],color:r?.instruction}),r?.invalid&&c.push({tag:e.tags.invalid,color:r?.invalid});const s=[];return Object.keys(t).length>0&&s.push(j.EditorView.theme(t,n)),c.length>0&&s.push(v.syntaxHighlighting(v.HighlightStyle.define(c))),s}function ot(a){return{editor:{...a.lhs?.editor,...a.rhs?.editor},highlight:{...a.lhs?.highlight,...a.rhs?.highlight},allowsFallback:a.rhs?.allowsFallback??a.lhs?.allowsFallback}}const i={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark, .cm-md-bold.tok-meta, .cm-md-italic.tok-meta, .cm-md-strikethrough.tok-meta",boldText:".cm-md-bold:not(.tok-meta)",italicText:".cm-md-italic:not(.tok-meta)",quoteText:".cm-md-quote:not(.cm-md-quoteMark)",dividerColor:".cm-md-horizontalRule"},rt=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${i.lineGutter} {}
${i.foldGutter} {}
${i.visibleSpace} {}
${i.matchingBracket} {}
${i.activeIndicator} {}
${i.accentColor} {}
${i.syntaxMarker} {}
${i.boldText} {}
${i.italicText} {}
${i.quoteText} {}
${i.dividerColor} {}
`,R=window,at=R.__extractStyleRules__??(a=>a.value?.rules),ct=R.__extractHighlightSpecs__??(a=>a.value?.specs);function nt(a){const n=document.createElement("style");return n.textContent=a,document.head.appendChild(n),n}function it(a){if(a.length===0)return[{},[]];const n=w(a);return[Object.fromEntries(n.flatMap(c=>{const o=at(c)?.join(`
`)??"";return Object.entries(lt(o))})),n.flatMap(c=>ct(c)??[])]}function f(a,n,t){return a.find(c=>!!(c.tag.toString().includes(n.toString())&&c.color!==void 0))?.color??t}function S(a,n,t){for(const[c,o]of Object.entries(a))if(c.includes(n)&&(t===void 0||!c.includes(t))){const r=o.background??o.backgroundColor;if(r!==void 0)return r}}function st(a){const n=a.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(n===null)return;const[t,c,o]=n.slice(1,4).map(Number);return`rgba(${t}, ${c}, ${o}, 0.6)`}function H(a){const n=o=>o!==null&&typeof o=="object";if(!n(a))return!0;const t=Object.entries(a),c=o=>o!=null;for(const[,o]of t)if(n(o)){if(!H(o))return!1}else if(c(o))return!1;return!0}function w(a){return Array.isArray(a)?a.flatMap(w):"extension"in a?w(a.extension):[a]}function lt(a){const n={},t=new CSSStyleSheet;t.replaceSync(a);for(const c of t.cssRules){const{style:o,selectorText:r}=c,{background:s,backgroundColor:d}=o;n[r]={},s.length>0&&(n[r].background=s),d.length>0&&(n[r].backgroundColor=d)}return n}function gt(a){const n=a.options?.settingsKey,t=G(F(n));a.light!==void 0&&y(!1,t)&&(l().customThemes.light=a.light),a.dark!==void 0&&y(!0,t)&&(l().customThemes.dark=a.dark),typeof k.MarkEdit.editorView=="object"&&L(k.MarkEdit.editorView)}const p=window,l=()=>p.__markeditTheming__,I=matchMedia("(prefers-color-scheme: dark)");typeof l()!="object"&&dt();function dt(){p.__markeditTheming__={styleSheet:nt(rt),configurator:new X.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},k.MarkEdit.addExtension(l().configurator.of([])),k.MarkEdit.onEditorReady(n=>L(n));const a=()=>setTimeout(()=>L(k.MarkEdit.editorView),15);I.addEventListener("change",a),l().mainThemeName=p.config.theme,Object.defineProperty(p.config,"theme",{get(){return l().mainThemeName},set(n){l().mainThemeName=n,a()}})}function L(a){const n=I.matches,t=n?l().customThemes.dark:l().customThemes.light,{extensions:c,colors:o}=et(n,t?.extension,t?.colors);a.dispatch({effects:l().configurator.reconfigure(c)});const[r,s]=it(c),d=c.length===0&&H(o),m=o.allowsFallback??t?.extension!==void 0;l().styleSheet.disabled=d,ut(a,n,d,r,s,o,m)}function ut(a,n,t,c,o,r,s){const d=S(c,".cm-activeLine",".cm-activeLineGutter"),m=S(c,i.selectionBackground),x=S(c,i.matchingBracket),B=getComputedStyle(a.contentDOM).color,$=r.editor?.visibleSpaceColor??st(B),h=s?B:void 0,O=f(o,e.tags.heading,h),V=f(o,e.tags.processingInstruction,h),A=f(o,e.tags.strong,h),K=f(o,e.tags.emphasis,h),z=f(o,e.tags.quote,h),U=f(o,e.tags.contentSeparator,h),D=[[i.activeIndicator,d,"background"],[i.matchingBracket,x,"background"],[i.lineGutter,B,"color"],[i.foldGutter,$,"color"],[i.visibleSpace,$,"color"],[i.accentColor,O,"color"],[i.syntaxMarker,V,"color"],[i.boldText,A,"color"],[i.italicText,K,"color"],[i.quoteText,z,"color"],[i.dividerColor,U,"color"]],W=Array.from(document.querySelectorAll("style")),b=n?l().darkOriginalRules:l().lightOriginalRules;for(const J of W){const T=J.sheet?.cssRules;if(T!==void 0)for(let M=0;M<T.length;++M){const g=T[M],u=g.selectorText??"";u.includes(".cm-focused")&&u.includes(i.selectionBackground)&&(b.selectionBackground??=g.cssText,t?g.cssText=b.selectionBackground:m!==void 0&&g.style.setProperty("background",m,"important")),O!==void 0&&(u===".cm-md-header"||u===".cm-md-header:not(.cm-md-quote)")&&(b.markdownHeader??=g.cssText,t?g.cssText=b.markdownHeader:g.style.removeProperty("color"));for(const[Q,P,_]of D)u===Q&&(P===void 0?g.style.removeProperty(_):(g.style.setProperty(_,P,"important"),(u===i.matchingBracket||u===i.activeIndicator)&&g.style.setProperty("box-shadow","unset","important")))}}}function N(){return N=Object.assign?Object.assign.bind():function(a){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var c in t)({}).hasOwnProperty.call(t,c)&&(a[c]=t[c])}return a},N.apply(null,arguments)}var mt=a=>{var{theme:n,settings:t={},styles:c=[]}=a,o={".cm-gutters":{}},r={};t.background&&(r.backgroundColor=t.background),t.backgroundImage&&(r.backgroundImage=t.backgroundImage),t.foreground&&(r.color=t.foreground),t.fontSize&&(r.fontSize=t.fontSize),(t.background||t.foreground)&&(o["&"]=r),t.fontFamily&&(o["&.cm-editor .cm-scroller"]={fontFamily:t.fontFamily}),t.gutterBackground&&(o[".cm-gutters"].backgroundColor=t.gutterBackground),t.gutterForeground&&(o[".cm-gutters"].color=t.gutterForeground),t.gutterBorder&&(o[".cm-gutters"].borderRightColor=t.gutterBorder),t.caret&&(o[".cm-content"]={caretColor:t.caret},o[".cm-cursor, .cm-dropCursor"]={borderLeftColor:t.caret});var s={};t.gutterActiveForeground&&(s.color=t.gutterActiveForeground),t.lineHighlight&&(o[".cm-activeLine"]={backgroundColor:t.lineHighlight},s.backgroundColor=t.lineHighlight),o[".cm-activeLineGutter"]=s,t.selection&&(o["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:t.selection+" !important"}),t.selectionMatch&&(o["& .cm-selectionMatch"]={backgroundColor:t.selectionMatch});var d=j.EditorView.theme(o,{dark:n==="dark"}),m=v.HighlightStyle.define(c),x=[d,v.syntaxHighlighting(m)];return x},ht={background:"#f2f1f8",foreground:"#0c006b",caret:"#5c49e9",selection:"#d5d1f2",selectionMatch:"#d5d1f2",gutterBackground:"#f2f1f8",gutterForeground:"#0c006b70",lineHighlight:"#16067911"},ft=[{tag:e.tags.comment,color:"#9995b7"},{tag:e.tags.keyword,color:"#ff5792",fontWeight:"bold"},{tag:[e.tags.definitionKeyword,e.tags.modifier],color:"#ff5792"},{tag:[e.tags.className,e.tags.tagName,e.tags.definition(e.tags.typeName)],color:"#0094f0"},{tag:[e.tags.number,e.tags.bool,e.tags.null,e.tags.special(e.tags.brace)],color:"#5842ff"},{tag:[e.tags.definition(e.tags.propertyName),e.tags.function(e.tags.variableName)],color:"#0095a8"},{tag:e.tags.typeName,color:"#b3694d"},{tag:[e.tags.propertyName,e.tags.variableName],color:"#fa8900"},{tag:e.tags.operator,color:"#ff5792"},{tag:e.tags.self,color:"#e64100"},{tag:[e.tags.string,e.tags.regexp],color:"#00b368"},{tag:[e.tags.paren,e.tags.bracket],color:"#0431fa"},{tag:e.tags.labelName,color:"#00bdd6"},{tag:e.tags.attributeName,color:"#e64100"},{tag:e.tags.angleBracket,color:"#9995b7"}],kt=a=>{var{theme:n="light",settings:t={},styles:c=[]}={};return mt({theme:n,settings:N({},ht,t),styles:[...ft,...c]})},bt=kt();gt({light:{extension:bt},options:{settingsKey:"extension.markeditThemeNoctisLilac"}});
